# abs_worker Environment Configuration
# Copy this file to .env and customize for your environment

# =============================================================================
# Blockchain Confirmation Settings
# =============================================================================

# Number of block confirmations required before marking transaction as complete
# Recommendation: 3-12 blocks depending on blockchain (3 for Polygon, 12 for Ethereum)
REQUIRED_CONFIRMATIONS=3

# Maximum time to wait for transaction confirmation (seconds)
# Recommendation: 600 for fast chains (Polygon), 1800 for slower chains (Ethereum)
MAX_CONFIRMATION_WAIT=600


# =============================================================================
# Retry Settings
# =============================================================================

# Maximum number of retry attempts for failed operations
MAX_RETRIES=3

# Initial delay between retry attempts (seconds)
RETRY_DELAY=5

# Multiplier for exponential backoff between retries
# Example: attempt 1 waits 5s, attempt 2 waits 10s, attempt 3 waits 20s
RETRY_BACKOFF_MULTIPLIER=2.0


# =============================================================================
# Transaction Monitoring
# =============================================================================

# Interval between transaction status polls (seconds)
# Lower = faster feedback, higher = less blockchain RPC load
POLL_INTERVAL=2

# Maximum number of polling attempts before timeout
# Total wait time = POLL_INTERVAL * MAX_POLL_ATTEMPTS
MAX_POLL_ATTEMPTS=100


# =============================================================================
# Certificate Settings
# =============================================================================

# Base path for storing generated certificates
# Make sure this directory exists and is writable
CERT_STORAGE_PATH=/var/abs_notary/certificates

# Generate signed JSON certificates (machine-readable)
CERT_JSON_ENABLED=true

# Generate signed PDF certificates (human-readable with QR code)
CERT_PDF_ENABLED=true


# =============================================================================
# Worker Settings
# =============================================================================

# Worker service name for logging
WORKER_NAME=abs_worker

# Enable structured JSON logging via abs_utils
ENABLE_STRUCTURED_LOGGING=true


# =============================================================================
# Optional: Celery Configuration (Phase 2)
# =============================================================================
# Uncomment these when migrating to Celery

# CELERY_BROKER_URL=redis://localhost:6379/0
# CELERY_RESULT_BACKEND=redis://localhost:6379/0
# CELERY_TASK_SERIALIZER=json
# CELERY_RESULT_SERIALIZER=json
# CELERY_ACCEPT_CONTENT=["json"]
# CELERY_TIMEZONE=UTC
# CELERY_ENABLE_UTC=true


# =============================================================================
# Development vs Production Recommendations
# =============================================================================

# DEVELOPMENT:
# - REQUIRED_CONFIRMATIONS=1 (faster feedback)
# - POLL_INTERVAL=1 (faster polling)
# - MAX_RETRIES=2 (fewer retries)
# - CERT_STORAGE_PATH=./dev_certificates (local directory)

# PRODUCTION:
# - REQUIRED_CONFIRMATIONS=3-12 (depending on blockchain security needs)
# - POLL_INTERVAL=2-5 (balance between responsiveness and RPC load)
# - MAX_RETRIES=3-5 (more resilience)
# - CERT_STORAGE_PATH=/var/abs_notary/certificates (persistent volume)
